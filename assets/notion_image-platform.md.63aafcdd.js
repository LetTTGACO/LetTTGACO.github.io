import{_ as s,c as t,o as a,a as n}from"./app.61ba913b.js";const h=JSON.parse('{"title":"图床平台配置","description":"","frontmatter":{"status":"已发布","sort":120,"urlname":"image-platform","上次编辑时间":"2023-10-13T16:00:00.000Z","catalog":"配置详情","tags":"Elog-Docs","title":"图床平台配置","date":"2023-10-13 05:24:00","updated":"2023-10-13 16:00:00"},"headers":[],"relativePath":"notion/image-platform.md","lastUpdated":1698375760000}'),e={name:"notion/image-platform.md"},l=n(`<h1 id="图床平台配置" tabindex="-1">图床平台配置 <a class="header-anchor" href="#图床平台配置" aria-hidden="true">#</a></h1><p>图床关键信息获取及配置流程请移步 <a href="/notion/gvnxobqogetukays#图床">关键信息获取</a> 页面。</p><h2 id="本地存储-local" tabindex="-1">本地存储（local） <a class="header-anchor" href="#本地存储-local" aria-hidden="true">#</a></h2><table><thead><tr><th>字段</th><th>必填</th><th>说明</th><th>默认值</th></tr></thead><tbody><tr><td>outputDir</td><td>是</td><td>图片输出目录</td><td>-</td></tr><tr><td>prefixKey</td><td>否</td><td>图片资源统一前缀</td><td>-</td></tr></tbody></table><h3 id="prefixkey-字段说明" tabindex="-1">PrefixKey 字段说明 <a class="header-anchor" href="#prefixkey-字段说明" aria-hidden="true">#</a></h3><ol><li>本地部署平台一般会有资源根目录，会将某个文件夹视为根目录，而<code>prefixKey</code>就是配置资源目录的前缀</li><li>例如 Vitpress，如果<code>outputDir=./docs/asset/images</code>，则<code>prefixKey=/asset/images</code></li></ol><h2 id="腾讯云-cos-阿里云-oss-七牛云-qiniu" tabindex="-1">腾讯云（cos）/阿里云（oss）/七牛云（qiniu） <a class="header-anchor" href="#腾讯云-cos-阿里云-oss-七牛云-qiniu" aria-hidden="true">#</a></h2><table><thead><tr><th>字段</th><th>必填</th><th>说明</th><th>默认值</th></tr></thead><tbody><tr><td>secretId</td><td>是</td><td>图床密钥 ID</td><td>-</td></tr><tr><td>secretKey</td><td>是</td><td>图床密钥 KEY</td><td>-</td></tr><tr><td>bucket</td><td>是</td><td>桶名称/七牛云空间</td><td>-</td></tr><tr><td>region</td><td>是</td><td>存储区域，<strong>七牛云可不填</strong></td><td>-</td></tr><tr><td>host</td><td>否</td><td>指定域名，<strong>七牛云必填</strong></td><td>-</td></tr><tr><td>prefixKey</td><td>否</td><td>上传路径，默认上传到根路径</td><td>-</td></tr><tr><td>secretExt</td><td>否</td><td>图床密钥拓展点</td><td>-</td></tr></tbody></table><h2 id="又拍云-upyun" tabindex="-1">又拍云（upyun） <a class="header-anchor" href="#又拍云-upyun" aria-hidden="true">#</a></h2><table><thead><tr><th>字段</th><th>必填</th><th>说明</th><th>默认值</th></tr></thead><tbody><tr><td>user</td><td>是</td><td>操作员账号</td><td>-</td></tr><tr><td>password</td><td>是</td><td>操作员密码</td><td>-</td></tr><tr><td>bucket</td><td>是</td><td>服务名</td><td>-</td></tr><tr><td>host</td><td>否</td><td>指定域名，又拍云会默认提供 30 天的临时测试域名，建议配置自定义域名</td><td>临时域名：<a href="http://xxx.est.upcdn.net" target="_blank" rel="noreferrer">http://xxx.est.upcdn.net</a></td></tr><tr><td>prefixKey</td><td>否</td><td>上传路径，默认上传到根路径</td><td>-</td></tr><tr><td>secretExt</td><td>否</td><td>图床密钥拓展点</td><td>-</td></tr></tbody></table><h2 id="github-图床-github" tabindex="-1">Github 图床（github） <a class="header-anchor" href="#github-图床-github" aria-hidden="true">#</a></h2><table><thead><tr><th>字段</th><th>必填</th><th>说明</th><th>默认值</th></tr></thead><tbody><tr><td>token</td><td>是</td><td>Github Token</td><td>-</td></tr><tr><td>user</td><td>是</td><td>用户名</td><td>-</td></tr><tr><td>repo</td><td>是</td><td>仓库名</td><td>-</td></tr><tr><td>branch</td><td>否</td><td>分支</td><td>master</td></tr><tr><td>host</td><td>否</td><td>加速域名，取值 <a href="http://cdn.jsdelivr.net" target="_blank" rel="noreferrer">cdn.jsdelivr.net</a></td><td>-</td></tr><tr><td>prefixKey</td><td>否</td><td>上传路径，默认上传到根路径</td><td>-</td></tr><tr><td>secretExt</td><td>否</td><td>图床密钥拓展点</td><td>-</td></tr></tbody></table><h3 id="secretext-字段说明" tabindex="-1">secretExt 字段说明 <a class="header-anchor" href="#secretext-字段说明" aria-hidden="true">#</a></h3><p>图床密钥拓展点路径，一般适用于不想直接配置 AK 到环境变量或者本地，而是通过异步接口获取</p><ol><li><p>目前只支持 Common Js 标准拓展点</p></li><li><p>拓展点需要暴露一个<strong>同步/异步</strong>的 <code>getSecret</code> 的方法</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> axios </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">require</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">axios</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> getOssSts </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">async</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">()</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">axios</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">https://xxxx/oss/sts?directory=elog</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> getSecret </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">async</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">()</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">res</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">getOssSts</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#BABED8;">accessKeyId</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#BABED8;">accessKeySecret</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#BABED8;">securityToken</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#BABED8;">dir</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#BABED8;">region</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#BABED8;">bucket</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">res</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">data</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">data</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    secretId</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">accessKeyId</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    secretKey</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">accessKeySecret</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    stsToken</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">securityToken</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    secure</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    prefixKey</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">dir</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#BABED8;">region</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#BABED8;">bucket</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">module.exports</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">  getSecret</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span></code></pre></div></li><li><p><code>getSecret</code> 返回的密钥信息需要符合图床实例 SDK 的字段要求，具体请参考对应图床 SDK/API</p></li></ol><h2 id="下一步" tabindex="-1">下一步 <a class="header-anchor" href="#下一步" aria-hidden="true">#</a></h2><p><strong>马上就大功告成了，最后一步：点击</strong> <a href="/notion/local-test">下一篇</a> <strong>继续配置本地调试环境</strong></p>`,17),o=[l];function p(r,d,c,y,i,F){return a(),t("div",null,o)}const B=s(e,[["render",p]]);export{h as __pageData,B as default};
